# Этапы калькулятора

## Последовательность шагов

### Шаг 1: Тип помещения (0% завершено)
- **ID элемента:** `step1`
- **Прогресс:** 0%
- **Поле:** `roomType` (radio)
- **Варианты:** квартира, частный дом, офис
- **Валидация:** Обязательный выбор

### Шаг 2: Количество створок (12% завершено)
- **ID элемента:** `step2`
- **Прогресс:** 12%
- **Поле:** `sashCount` (radio)
- **Варианты:** 1, 2, 3 створки
- **Валидация:** Обязательный выбор
- **Влияние:** Определяет следующие шаги

### Шаг 3: Размеры окна (25% завершено)
- **ID элемента:** `step3`
- **Прогресс:** 25%
- **Поля:**
  - `windowHeight` (number, мм)
  - `windowWidth` (number, мм)
- **Валидация:** 400-3000 мм, обязательное заполнение

### Шаг 4: Тип створки/створок (37% завершено)

#### Для 1 створки:
- **ID элемента:** `step4-single`
- **Прогресс:** 37%
- **Поле:** `sashType` (radio)
- **Варианты:** глухая, поворотная, поворотно-откидная
- **Дополнительно:** Аксессуары (если не глухая)
  - Москитная сетка
  - Детский замок

#### Для 2-3 створок (левая створка):
- **ID элемента:** `step4-left`
- **Прогресс:** 37%
- **Поле:** `leftSashType` (radio)
- **Варианты:** глухая, поворотная, поворотно-откидная
- **Дополнительно:** Аксессуары левой створки

### Шаг 5: Правая/средняя створка (37% завершено)
- **ID элемента:** `step5-right`
- **Прогресс:** 37%
- **Поле:** `rightSashType` (radio)
- **Варианты:** глухая, поворотная, поворотно-откидная
- **Дополнительно:** Аксессуары
- **Примечание:** Для 2 створок = правая, для 3 створок = средняя

### Шаг 6: Третья створка (37% завершено)
- **ID элемента:** `step6-third`
- **Прогресс:** 37%
- **Поле:** `thirdSashType` (radio)
- **Варианты:** глухая, поворотная, поворотно-откидная
- **Дополнительно:** Аксессуары третьей створки
- **Примечание:** Только для 3 створок

### Шаг 7: Дополнительные комплектующие (50% завершено)
- **ID элемента:** `step7`
- **Прогресс:** 50%
- **Поле:** `components` (checkbox, множественный выбор)
- **Варианты:**
  - Подоконник
  - Откосы
  - Отливы
- **Валидация:** Необязательно

### Шаг 8: Прокачка окна (62% завершено)
- **ID элемента:** `step8`
- **Прогресс:** 62%
- **Поле:** `features` (checkbox, множественный выбор)
- **Варианты с подсказками:**
  1. Шумоизоляция
  2. Теплосбережение
  3. Солнцезащита
  4. Микропроветривание
  5. Противовзломность
  6. Светопропускание
  7. Термопакет
  8. Ламинация
- **Валидация:** Необязательно, можно пропустить

### Шаг 9: Сводка (75% завершено)
- **ID элемента:** `step9`
- **Прогресс:** 75%
- **Функция:** Отображение всех выбранных параметров
- **Действия:**
  - Просмотр сводки
  - Редактирование (возврат к шагу 3)
  - Продолжить далее

### Шаг 10: Дополнительные услуги (87% завершено)
- **ID элемента:** `step10`
- **Прогресс:** 87%
- **Поля:**
  - `delivery` (radio): МКАД, Московская область, самовывоз
  - `lift` (radio): грузовой лифт, пассажирский лифт, не требуется, лифта нет
  - `installation` (radio): с монтажом, без монтажа
- **Валидация:** Обязательный выбор в каждой группе

### Шаг 11: Финальная форма (100% завершено)
- **ID элемента:** `step11`
- **Прогресс:** 100%
- **Поля:**
  - `phone` (tel): маска +7 (XXX) XXX-XX-XX
  - `agreement` (checkbox): согласие на обработку данных
- **Валидация:**
  - Телефон: 11 цифр
  - Согласие: обязательно
- **Действия:**
  - Генерация кода расчёта
  - Отправка в Telegram
  - Показ модального окна успеха

## Логика навигации

### Прямое движение (nextStep)

```
Шаг 1 → Шаг 2 → Шаг 3 → [Ветвление по створкам]

Если 1 створка:
  Шаг 3 → Шаг 4 (single) → Шаг 7

Если 2 створки:
  Шаг 3 → Шаг 4 (left) → Шаг 5 (right) → Шаг 7

Если 3 створки:
  Шаг 3 → Шаг 4 (left) → Шаг 5 (middle) → Шаг 6 (third) → Шаг 7

Далее всегда:
  Шаг 7 → Шаг 8 → Шаг 9 → Шаг 10 → Шаг 11
```

### Обратное движение (prevStep)

Работает в обратном порядке с учётом пропущенных шагов.

## Структура данных formData

```javascript
{
    roomType: 'apartment' | 'house' | 'office',
    sashCount: '1' | '2' | '3',
    windowHeight: '1400',
    windowWidth: '1200',

    // Для 1 створки
    sashType: 'fixed' | 'turn' | 'turn-tilt',
    accessories: ['mosquito', 'childlock'],

    // Для 2-3 створок
    leftSashType: 'fixed' | 'turn' | 'turn-tilt',
    leftAccessories: ['mosquito', 'childlock'],
    rightSashType: 'fixed' | 'turn' | 'turn-tilt',
    rightAccessories: ['mosquito', 'childlock'],

    // Для 3 створок
    thirdSashType: 'fixed' | 'turn' | 'turn-tilt',
    thirdAccessories: ['mosquito', 'childlock'],

    // Общие параметры
    components: ['sill', 'slopes', 'drip'],
    features: ['soundproof', 'energy', 'sun', ...],

    // Услуги
    delivery: 'mkad' | 'moscow' | 'pickup',
    lift: 'cargo' | 'passenger' | 'notneed' | 'nolift',
    installation: 'with' | 'without',

    // Контакты
    phone: '+7 (999) 123-45-67',
    agreement: true
}
```

## Ключевые функции

- `nextStep()` - переход на следующий шаг
- `prevStep()` - возврат на предыдущий шаг
- `validateStep(n)` - валидация текущего шага
- `showStep(n)` - отображение нужного шага
- `updateProgress()` - обновление прогресс-бара
- `displaySummary()` - формирование сводки на шаге 9
- `displayFinalSummary()` - финальная сводка на шаге 11
- `submitForm()` - отправка формы
- `sendToTelegram()` - отправка в Telegram
- `generateCalcCode()` - генерация уникального кода

## Модификация шагов

### Добавление нового варианта выбора

1. Добавьте HTML в соответствующий блок `<div class="step">`
2. Обновите валидацию в `validateStep()`
3. Добавьте поле в `formData`

### Изменение прогресса

Измените значения в объекте `progressMap` в `script.js`.

### Добавление нового шага

1. Создайте HTML блок с `class="step"` и уникальным ID
2. Добавьте прогресс в `progressMap`
3. Обновите логику в `nextStep()` и `prevStep()`
4. Добавьте валидацию в `validateStep()`
